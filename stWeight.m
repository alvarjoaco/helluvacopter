function [structW, engineW, driveSysW] = stWeight(Rad_s, nblades_s,...    chordIn, GrossInitial, isDuct, maxHPr, nRotors, isCoax)%% Duct Weight CalculationPanels = 111.1218; %lbs/ft^3Filling = 1; %lbs/ft^3cfthickness = 0.00082021.*2; %ft (0.5mm)thickness = 1; % %Chordchord2 = Rad_s; %ftlength = 2.*pi.*Rad_s;totpanels = 2.*length.*chord2.*cfthickness; %overestimate totfilling = length.*chord2.*(chord2.*thickness/100);%130 fillW = totfilling.*Filling;PanelW = totpanels.*Panels;if isDuct    DuctW = fillW+PanelW;else    DuctW = 0;end%% Fuselage Weight Calculation     fuselageW = GrossInitial.*380/2000; %lbs, independent of radius of rotor.%% Blade Weight Calculation     Bladeskin = 0.00082021.*2; %ft (0.5mm thick CF)bladeL = Rad_s; %ft radbladeC = chordIn; %ftbladeT = 10; % percentage thickChordnSpar = 2; % # of sparsFoamSwW = 2.5; %lbs/ft^3 includes CF skinHoneyCW = 1; %lbs/ft^3 same as for duct... Honeycomb. source?SparW = 0.06; %lbs/ft for 1 in high I beam% SparW = 0.11 %lbs/ft for 2 in high I beamleadEW = bladeC./2.*nSpar.*SparW.*bladeL+bladeC/2.*(bladeC*bladeT/120)...    .*bladeL.*FoamSwW;trailingEW = bladeC./2.*(bladeC.*bladeT./140).*bladeL.*HoneyCW+bladeC...    ./2.*bladeL.*Bladeskin;totbladeW = (leadEW+trailingEW)*nblades_s;%% Stator Weight Calculationnstator = 4;tubeW = 0.15; %lbs/ft;filletSkin = 0.00082021; %ft (0.25mm) thickness = as ductaerofilletW = 2.*bladeL.*nstator.*filletSkin;totstatorW = tubeW.*bladeL.*nstator+aerofilletW;if ~isDuct    totstatorW = 0;end%% Engine Weight Calculationpower2weightR = 1.23; %hp to lbs for BMW N47D20safetyFactor = 1.12; % max power required to MCPengineW = safetyFactor.*maxHPr./power2weightR;driveSysW = .5*engineW;%% Multi-Rotorif nRotors > 1 && ~isCoax    driveSysW = .6.*nRotors.*engineW;    fuselageW = .1.*nRotors.*fuselageW + fuselageW;end    %% Final Airframe Weight Add UpstructW2 = DuctW + fuselageW + totbladeW + totstatorW; %structure minus fuel tanktankVol = (GrossInitial - structW2)./6.183; %adding fuel tank estimatetankW = 0.95.*(.32125.*tankVol+4.4367); %fuel tank weight-ishstructW = DuctW + fuselageW + totbladeW + totstatorW + tankW; %final tally of wt.    %% Making the FractionsstructW = structW./GrossInitial;engineW = engineW./GrossInitial;driveSysW = driveSysW./GrossInitial;end